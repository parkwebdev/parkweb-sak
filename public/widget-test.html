<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ChatPad Widget Test Page</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    .container {
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    h1 {
      color: #1a1a1a;
      margin-bottom: 16px;
    }
    
    .status {
      background: #f0fdf4;
      border: 1px solid #86efac;
      border-radius: 8px;
      padding: 16px;
      margin: 20px 0;
    }
    
    .status h3 {
      color: #166534;
      margin: 0 0 8px 0;
    }
    
    .status p {
      color: #166534;
      margin: 0;
    }
    
    .info {
      background: #eff6ff;
      border: 1px solid #93c5fd;
      border-radius: 8px;
      padding: 16px;
      margin: 20px 0;
    }
    
    .info h3 {
      color: #1e40af;
      margin: 0 0 8px 0;
    }
    
    .info p {
      color: #1e40af;
      margin: 4px 0;
      font-size: 14px;
    }
    
    code {
      background: #f3f4f6;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
    }
    
    .content {
      line-height: 1.8;
      color: #4b5563;
    }
    
    .test-section {
      margin: 32px 0;
      padding: 24px;
      background: #f9fafb;
      border-radius: 8px;
    }
    
    .test-section h2 {
      color: #1a1a1a;
      margin-top: 0;
    }
    
    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    button:hover {
      background: #5a67d8;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    
    #console-output {
      background: #1a1a1a;
      color: #00ff00;
      padding: 16px;
      border-radius: 8px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 12px;
      max-height: 200px;
      overflow-y: auto;
      margin-top: 12px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üß™ ChatPad Widget Test Page</h1>
    
    <div class="status">
      <h3>‚úÖ Widget Loaded Successfully</h3>
      <p>The ChatPad widget should appear in the bottom-right corner of this page.</p>
    </div>
    
    <div class="info">
      <h3>üìã Testing Instructions</h3>
      <p><strong>1. Widget Visibility:</strong> Check if the widget button appears in the bottom-right corner</p>
      <p><strong>2. Click to Open:</strong> Click the widget button to open the chat interface</p>
      <p><strong>3. Test Features:</strong> Try the quick actions, announcements, and help articles</p>
      <p><strong>4. Check Styling:</strong> Verify colors, gradients, and branding match your configuration</p>
      <p><strong>5. Test Responsiveness:</strong> Resize your browser to test mobile view</p>
    </div>
    
    <div class="content">
      <h2>About This Test Page</h2>
      <p>
        This page demonstrates how the ChatPad widget appears when embedded on an external website.
        The widget is loaded using the same embed code that your users will use.
      </p>
      
      <p>
        The widget configuration is automatically fetched from your agent settings, including:
      </p>
      <ul>
        <li>Welcome message and branding</li>
        <li>Quick actions and custom fields</li>
        <li>Help articles and categories</li>
        <li>Announcements and promotional content</li>
        <li>Colors, gradients, and visual styling</li>
      </ul>
    </div>
    
    <div class="test-section">
      <h2>üîç Debug Console</h2>
      <p>Monitor widget loading and events:</p>
      <button onclick="checkWidget()">Check Widget Status</button>
      <button onclick="clearConsole()">Clear Console</button>
      <div id="console-output"></div>
    </div>
    
    <div class="test-section">
      <h2>üìù Sample Content</h2>
      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor 
        incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud 
        exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
      </p>
      <p>
        Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu 
        fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in 
        culpa qui officia deserunt mollit anim id est laborum.
      </p>
      <p>
        This content helps test the widget's positioning and behavior when scrolling through 
        a real page. Try scrolling to see how the widget stays fixed in position.
      </p>
    </div>
  </div>
  
  <!-- ChatPad Widget Embed Code -->
  <!-- Replace the data-agent-id with your actual agent ID -->
  <script
    src="https://mvaimvwdukpgvkifkfpa.supabase.co/functions/v1/serve-widget"
    data-agent-id="25b7bed8-3071-4630-8c22-d6f14a6b2671"
    data-primary-color="#667eea"
    data-position="bottom-right"
  ></script>
  
  <script>
    function log(message, type = 'info') {
      const output = document.getElementById('console-output');
      const timestamp = new Date().toLocaleTimeString();
      const color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#00ff00';
      output.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
      output.scrollTop = output.scrollHeight;
    }
    
    function checkWidget() {
      log('Checking widget status...', 'info');
      
      // Check if widget frame exists
      const frame = document.getElementById('chatpad-widget-frame');
      if (frame) {
        log('‚úì Widget iframe found', 'success');
        log(`  Position: ${frame.style.cssText.includes('right') ? 'bottom-right' : 'bottom-left'}`, 'info');
        log(`  Visibility: ${frame.style.display === 'none' ? 'hidden' : 'visible'}`, 'info');
      } else {
        log('‚úó Widget iframe not found', 'error');
      }
      
      // Check if config exists
      if (window.chatpadWidgetConfig) {
        log('‚úì Widget config loaded', 'success');
        log(`  Agent: ${window.chatpadWidgetConfig.agentName || 'N/A'}`, 'info');
        log(`  Agent ID: ${window.chatpadWidgetConfig.agentId || 'N/A'}`, 'info');
      } else {
        log('‚úó Widget config not found', 'error');
      }
    }
    
    function clearConsole() {
      document.getElementById('console-output').innerHTML = '';
    }
    
    // Auto-check on load
    window.addEventListener('load', () => {
      setTimeout(() => {
        log('Page loaded, checking widget...', 'info');
        checkWidget();
      }, 2000);
    });
    
    // Listen for widget events
    console.log('[Test Page] Widget test page loaded');
    console.log('[Test Page] Waiting for widget to initialize...');
  </script>
</body>
</html>
